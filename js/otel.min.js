(()=>{var Di=Object.defineProperty;var Mi=(t,e,r)=>e in t?Di(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var c=(t,e,r)=>Mi(t,typeof e!="symbol"?e+"":e,r);var on=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{};var z="1.9.0";var sn=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Ui(t){var e=new Set([t]),r=new Set,n=t.match(sn);if(!n)return function(){return!1};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(u){return u===t};function i(a){return r.add(a),!1}function s(a){return e.add(a),!0}return function(u){if(e.has(u))return!0;if(r.has(u))return!1;var p=u.match(sn);if(!p)return i(u);var l={major:+p[1],minor:+p[2],patch:+p[3],prerelease:p[4]};return l.prerelease!=null||o.major!==l.major?i(u):o.major===0?o.minor===l.minor&&o.patch<=l.patch?s(u):i(u):o.minor<=l.minor?s(u):i(u)}}var an=Ui(z);var Gi=z.split(".")[0],bt=Symbol.for("opentelemetry.js.api."+Gi),Ct=on;function H(t,e,r,n){var o;n===void 0&&(n=!1);var i=Ct[bt]=(o=Ct[bt])!==null&&o!==void 0?o:{version:z};if(!n&&i[t]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(s.stack||s.message),!1}if(i.version!==z){var s=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+t+" does not match previously registered API v"+z);return r.error(s.stack||s.message),!1}return i[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+z+"."),!0}function C(t){var e,r,n=(e=Ct[bt])===null||e===void 0?void 0:e.version;if(!(!n||!an(n)))return(r=Ct[bt])===null||r===void 0?void 0:r[t]}function V(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+z+".");var r=Ct[bt];r&&delete r[t]}var Hi=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},Vi=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},cn=(function(){function t(e){this._namespace=e.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return It("debug",this._namespace,e)},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return It("error",this._namespace,e)},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return It("info",this._namespace,e)},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return It("warn",this._namespace,e)},t.prototype.verbose=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return It("verbose",this._namespace,e)},t})();function It(t,e,r){var n=C("diag");if(n)return r.unshift(e),n[t].apply(n,Vi([],Hi(r),!1))}var L;(function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})(L||(L={}));function un(t,e){t<L.NONE?t=L.NONE:t>L.ALL&&(t=L.ALL),e=e||{};function r(n,o){var i=e[n];return typeof i=="function"&&t>=o?i.bind(e):function(){}}return{error:r("error",L.ERROR),warn:r("warn",L.WARN),info:r("info",L.INFO),debug:r("debug",L.DEBUG),verbose:r("verbose",L.VERBOSE)}}var Bi=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},ki=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},Fi="diag",v=(function(){function t(){function e(o){return function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var a=C("diag");if(a)return a[o].apply(a,ki([],Bi(i),!1))}}var r=this,n=function(o,i){var s,a,u;if(i===void 0&&(i={logLevel:L.INFO}),o===r){var p=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((s=p.stack)!==null&&s!==void 0?s:p.message),!1}typeof i=="number"&&(i={logLevel:i});var l=C("diag"),f=un((a=i.logLevel)!==null&&a!==void 0?a:L.INFO,o);if(l&&!i.suppressOverrideMessage){var T=(u=new Error().stack)!==null&&u!==void 0?u:"<failed to generate stacktrace>";l.warn("Current logger will be overwritten from "+T),f.warn("Current logger will overwrite one already registered from "+T)}return H("diag",f,r,!0)};r.setLogger=n,r.disable=function(){V(Fi,r)},r.createComponentLogger=function(o){return new cn(o)},r.verbose=e("verbose"),r.debug=e("debug"),r.info=e("info"),r.warn=e("warn"),r.error=e("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t})();var ji=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},Ki=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},pn=(function(){function t(e){this._entries=e?new Map(e):new Map}return t.prototype.getEntry=function(e){var r=this._entries.get(e);if(r)return Object.assign({},r)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var r=ji(e,2),n=r[0],o=r[1];return[n,o]})},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=new t(this._entries);try{for(var s=Ki(n),a=s.next();!a.done;a=s.next()){var u=a.value;i._entries.delete(u)}}catch(p){e={error:p}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return i},t.prototype.clear=function(){return new t},t})();var ln=Symbol("BaggageEntryMetadata");var zi=v.instance();function _n(t){return t===void 0&&(t={}),new pn(new Map(Object.entries(t)))}function rr(t){return typeof t!="string"&&(zi.error("Cannot create baggage metadata from unknown type: "+typeof t),t=""),{__TYPE__:ln,toString:function(){return t}}}function nt(t){return Symbol.for(t)}var $i=(function(){function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var i=new t(r._currentContext);return i._currentContext.set(n,o),i},r.deleteValue=function(n){var o=new t(r._currentContext);return o._currentContext.delete(n),o}}return t})(),M=new $i;var ot=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Yi=(function(){function t(){}return t.prototype.createGauge=function(e,r){return rs},t.prototype.createHistogram=function(e,r){return ns},t.prototype.createCounter=function(e,r){return es},t.prototype.createUpDownCounter=function(e,r){return os},t.prototype.createObservableGauge=function(e,r){return ss},t.prototype.createObservableCounter=function(e,r){return is},t.prototype.createObservableUpDownCounter=function(e,r){return as},t.prototype.addBatchObservableCallback=function(e,r){},t.prototype.removeBatchObservableCallback=function(e){},t})();var pe=(function(){function t(){}return t})();var Xi=(function(t){ot(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e})(pe);var Wi=(function(t){ot(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e})(pe);var qi=(function(t){ot(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.record=function(r,n){},e})(pe);var Qi=(function(t){ot(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.record=function(r,n){},e})(pe);var nr=(function(){function t(){}return t.prototype.addCallback=function(e){},t.prototype.removeCallback=function(e){},t})();var Ji=(function(t){ot(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(nr);var Zi=(function(t){ot(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(nr);var ts=(function(t){ot(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(nr);var fn=new Yi,es=new Xi,rs=new qi,ns=new Qi,os=new Wi,is=new Ji,ss=new Zi,as=new ts;var dn={get:function(t,e){if(t!=null)return t[e]},keys:function(t){return t==null?[]:Object.keys(t)}},mn={set:function(t,e,r){t!=null&&(t[e]=r)}};var cs=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},us=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},Tn=(function(){function t(){}return t.prototype.active=function(){return M},t.prototype.with=function(e,r,n){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];return r.call.apply(r,us([n],cs(o),!1))},t.prototype.bind=function(e,r){return r},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t})();var ps=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return i},ls=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},or="context",_s=new Tn,J=(function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(e){return H(or,e,v.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(e,r,n){for(var o,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(o=this._getContextManager()).with.apply(o,ls([e,r,n],ps(i),!1))},t.prototype.bind=function(e,r){return this._getContextManager().bind(e,r)},t.prototype._getContextManager=function(){return C(or)||_s},t.prototype.disable=function(){this._getContextManager().disable(),V(or,v.instance())},t})();var P;(function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})(P||(P={}));var le="0000000000000000",_e="00000000000000000000000000000000",wt={traceId:_e,spanId:le,traceFlags:P.NONE};var Z=(function(){function t(e){e===void 0&&(e=wt),this._spanContext=e}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return this},t.prototype.setAttributes=function(e){return this},t.prototype.addEvent=function(e,r){return this},t.prototype.addLink=function(e){return this},t.prototype.addLinks=function(e){return this},t.prototype.setStatus=function(e){return this},t.prototype.updateName=function(e){return this},t.prototype.end=function(e){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(e,r){},t})();var ir=nt("OpenTelemetry Context Key SPAN");function fe(t){return t.getValue(ir)||void 0}function hn(){return fe(J.getInstance().active())}function Dt(t,e){return t.setValue(ir,e)}function En(t){return t.deleteValue(ir)}function gn(t,e){return Dt(t,new Z(e))}function de(t){var e;return(e=fe(t))===null||e===void 0?void 0:e.spanContext()}var fs=/^([0-9a-f]{32})$/i,ds=/^[0-9a-f]{16}$/i;function me(t){return fs.test(t)&&t!==_e}function Sn(t){return ds.test(t)&&t!==le}function $(t){return me(t.traceId)&&Sn(t.spanId)}function An(t){return new Z(t)}var sr=J.getInstance(),Te=(function(){function t(){}return t.prototype.startSpan=function(e,r,n){n===void 0&&(n=sr.active());var o=!!(r!=null&&r.root);if(o)return new Z;var i=n&&de(n);return ms(i)&&$(i)?new Z(i):new Z},t.prototype.startActiveSpan=function(e,r,n,o){var i,s,a;if(!(arguments.length<2)){arguments.length===2?a=r:arguments.length===3?(i=r,a=n):(i=r,s=n,a=o);var u=s!=null?s:sr.active(),p=this.startSpan(e,i,u),l=Dt(u,p);return sr.with(l,a,void 0,p)}},t})();function ms(t){return typeof t=="object"&&typeof t.spanId=="string"&&typeof t.traceId=="string"&&typeof t.traceFlags=="number"}var Ts=new Te,Rn=(function(){function t(e,r,n,o){this._provider=e,this.name=r,this.version=n,this.options=o}return t.prototype.startSpan=function(e,r,n){return this._getTracer().startSpan(e,r,n)},t.prototype.startActiveSpan=function(e,r,n,o){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):Ts},t})();var xn=(function(){function t(){}return t.prototype.getTracer=function(e,r,n){return new Te},t})();var hs=new xn,ar=(function(){function t(){}return t.prototype.getTracer=function(e,r,n){var o;return(o=this.getDelegateTracer(e,r,n))!==null&&o!==void 0?o:new Rn(this,e,r,n)},t.prototype.getDelegate=function(){var e;return(e=this._delegate)!==null&&e!==void 0?e:hs},t.prototype.setDelegate=function(e){this._delegate=e},t.prototype.getDelegateTracer=function(e,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getTracer(e,r,n)},t})();var Tt;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Tt||(Tt={}));var it;(function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})(it||(it={}));var U;(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(U||(U={}));var E=J.getInstance();var _=v.instance();var Es=(function(){function t(){}return t.prototype.getMeter=function(e,r,n){return fn},t})();var On=new Es;var cr="metrics",Nn=(function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(e){return H(cr,e,v.instance())},t.prototype.getMeterProvider=function(){return C(cr)||On},t.prototype.getMeter=function(e,r,n){return this.getMeterProvider().getMeter(e,r,n)},t.prototype.disable=function(){V(cr,v.instance())},t})();var Mt=Nn.getInstance();var yn=(function(){function t(){}return t.prototype.inject=function(e,r){},t.prototype.extract=function(e,r){return e},t.prototype.fields=function(){return[]},t})();var ur=nt("OpenTelemetry Baggage Key");function pr(t){return t.getValue(ur)||void 0}function vn(){return pr(J.getInstance().active())}function Ln(t,e){return t.setValue(ur,e)}function Pn(t){return t.deleteValue(ur)}var lr="propagation",gs=new yn,bn=(function(){function t(){this.createBaggage=_n,this.getBaggage=pr,this.getActiveBaggage=vn,this.setBaggage=Ln,this.deleteBaggage=Pn}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(e){return H(lr,e,v.instance())},t.prototype.inject=function(e,r,n){return n===void 0&&(n=mn),this._getGlobalPropagator().inject(e,r,n)},t.prototype.extract=function(e,r,n){return n===void 0&&(n=dn),this._getGlobalPropagator().extract(e,r,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){V(lr,v.instance())},t.prototype._getGlobalPropagator=function(){return C(lr)||gs},t})();var I=bn.getInstance();var _r="trace",Cn=(function(){function t(){this._proxyTracerProvider=new ar,this.wrapSpanContext=An,this.isSpanContextValid=$,this.deleteSpan=En,this.getSpan=fe,this.getActiveSpan=hn,this.getSpanContext=de,this.setSpan=Dt,this.setSpanContext=gn}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(e){var r=H(_r,this._proxyTracerProvider,v.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},t.prototype.getTracerProvider=function(){return C(_r)||this._proxyTracerProvider},t.prototype.getTracer=function(e,r){return this.getTracerProvider().getTracer(e,r)},t.prototype.disable=function(){V(_r,v.instance()),this._proxyTracerProvider=new ar},t})();var g=Cn.getInstance();var In=nt("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function fr(t){return t.setValue(In,!0)}function st(t){return t.getValue(In)===!0}var Ee="baggage";function wn(t){return t.reduce((e,r)=>{let n=`${e}${e!==""?",":""}${r}`;return n.length>8192?e:n},"")}function Dn(t){return t.getAllEntries().map(([e,r])=>{let n=`${encodeURIComponent(e)}=${encodeURIComponent(r.value)}`;return r.metadata!==void 0&&(n+=";"+r.metadata.toString()),n})}function Mn(t){if(!t)return;let e=t.indexOf(";"),r=e===-1?t:t.substring(0,e),n=r.indexOf("=");if(n<=0)return;let o=r.substring(0,n).trim(),i=r.substring(n+1).trim();if(!o||!i)return;let s,a;try{s=decodeURIComponent(o),a=decodeURIComponent(i)}catch(p){return}let u;if(e!==-1&&e<t.length-1){let p=t.substring(e+1);u=rr(p)}return{key:s,value:a,metadata:u}}var Ut=class{inject(e,r,n){let o=I.getBaggage(e);if(!o||st(e))return;let i=Dn(o).filter(a=>a.length<=4096).slice(0,180),s=wn(i);s.length>0&&n.set(r,Ee,s)}extract(e,r,n){let o=n.get(r,Ee),i=Array.isArray(o)?o.join(","):o;if(!i)return e;let s={};return i.length===0||(i.split(",").forEach(u=>{let p=Mn(u);if(p){let l={value:p.value};p.metadata&&(l.metadata=p.metadata),s[p.key]=l}}),Object.entries(s).length===0)?e:I.setBaggage(e,I.createBaggage(s))}fields(){return[Ee]}};function at(t){let e={};if(typeof t!="object"||t==null)return e;for(let r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;if(!xs(r)){_.warn(`Invalid attribute key: ${r}`);continue}let n=t[r];if(!ge(n)){_.warn(`Invalid attribute value set for key: ${r}`);continue}Array.isArray(n)?e[r]=n.slice():e[r]=n}return e}function xs(t){return typeof t=="string"&&t!==""}function ge(t){return t==null?!0:Array.isArray(t)?Os(t):Un(typeof t)}function Os(t){let e;for(let r of t){if(r==null)continue;let n=typeof r;if(n!==e){if(!e){if(Un(n)){e=n;continue}return!1}return!1}}return!0}function Un(t){switch(t){case"number":case"boolean":case"string":return!0}return!1}function Gn(){return t=>{_.error(Ns(t))}}function Ns(t){return typeof t=="string"?t:JSON.stringify(ys(t))}function ys(t){let e={},r=t;for(;r!==null;)Object.getOwnPropertyNames(r).forEach(n=>{if(e[n])return;let o=r[n];o&&(e[n]=String(o))}),r=Object.getPrototypeOf(r);return e}var vs=Gn();function G(t){try{vs(t)}catch(e){}}var Hn="2.5.0";var mr="error.type";var Se="exception.message",Vn="exception.stacktrace",Ae="exception.type";var Bn="http.request.method";var kn="http.request.method_original";var Fn="http.response.status_code";var jn="server.address",Kn="server.port",zn="service.name";var Gt="telemetry.sdk.language";var $n="webjs",Ht="telemetry.sdk.name",Vt="telemetry.sdk.version";var ht="url.full";var Yn="user_agent.original";var Xn="process.runtime.name";var Et={[Ht]:"opentelemetry",[Xn]:"browser",[Gt]:$n,[Vt]:Hn};var y=performance;var Ls=9,Ps=6,bs=Math.pow(10,Ps),Re=Math.pow(10,Ls);function B(t){let e=t/1e3,r=Math.trunc(e),n=Math.round(t%1e3*bs);return[r,n]}function Y(t){let e=B(y.timeOrigin),r=B(typeof t=="number"?t:y.now());return Oe(e,r)}function ct(t){if(Bt(t))return t;if(typeof t=="number")return t<y.timeOrigin?Y(t):B(t);if(t instanceof Date)return B(t.getTime());throw TypeError("Invalid input type")}function Tr(t,e){let r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=Re),[r,n]}function D(t){return t[0]*Re+t[1]}function Bt(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function xe(t){return Bt(t)||typeof t=="number"||t instanceof Date}function Oe(t,e){let r=[t[0]+e[0],t[1]+e[1]];return r[1]>=Re&&(r[1]-=Re,r[0]+=1),r}var w;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(w||(w={}));var kt=class{constructor(e={}){c(this,"_propagators");c(this,"_fields");var r;this._propagators=(r=e.propagators)!=null?r:[],this._fields=Array.from(new Set(this._propagators.map(n=>typeof n.fields=="function"?n.fields():[]).reduce((n,o)=>n.concat(o),[])))}inject(e,r,n){for(let o of this._propagators)try{o.inject(e,r,n)}catch(i){_.warn(`Failed to inject with ${o.constructor.name}. Err: ${i.message}`)}}extract(e,r,n){return this._propagators.reduce((o,i)=>{try{return i.extract(o,r,n)}catch(s){_.warn(`Failed to extract with ${i.constructor.name}. Err: ${s.message}`)}return o},e)}fields(){return this._fields.slice()}};var hr="[_0-9a-z-*/]",Cs=`[a-z]${hr}{0,255}`,Is=`[a-z0-9]${hr}{0,240}@[a-z]${hr}{0,13}`,ws=new RegExp(`^(?:${Cs}|${Is})$`),Ds=/^[ -~]{0,255}[!-~]$/,Ms=/,|=/;function Wn(t){return ws.test(t)}function qn(t){return Ds.test(t)&&!Ms.test(t)}var Qn=32,Us=512,Jn=",",Zn="=",Ne=class t{constructor(e){c(this,"_internalState",new Map);e&&this._parse(e)}set(e,r){let n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n}unset(e){let r=this._clone();return r._internalState.delete(e),r}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,r)=>(e.push(r+Zn+this.get(r)),e),[]).join(Jn)}_parse(e){e.length>Us||(this._internalState=e.split(Jn).reverse().reduce((r,n)=>{let o=n.trim(),i=o.indexOf(Zn);if(i!==-1){let s=o.slice(0,i),a=o.slice(i+1,n.length);Wn(s)&&qn(a)&&r.set(s,a)}return r},new Map),this._internalState.size>Qn&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,Qn))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new t;return e._internalState=new Map(this._internalState),e}};var gt="traceparent",ye="tracestate",Gs="00",Hs="(?!ff)[\\da-f]{2}",Vs="(?![0]{32})[\\da-f]{32}",Bs="(?![0]{16})[\\da-f]{16}",ks="[\\da-f]{2}",Fs=new RegExp(`^\\s?(${Hs})-(${Vs})-(${Bs})-(${ks})(-.*)?\\s?$`);function to(t){let e=Fs.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}var Ft=class{inject(e,r,n){let o=g.getSpanContext(e);if(!o||st(e)||!$(o))return;let i=`${Gs}-${o.traceId}-${o.spanId}-0${Number(o.traceFlags||P.NONE).toString(16)}`;n.set(r,gt,i),o.traceState&&n.set(r,ye,o.traceState.serialize())}extract(e,r,n){let o=n.get(r,gt);if(!o)return e;let i=Array.isArray(o)?o[0]:o;if(typeof i!="string")return e;let s=to(i);if(!s)return e;s.isRemote=!0;let a=n.get(r,ye);if(a){let u=Array.isArray(a)?a.join(","):a;s.traceState=new Ne(typeof u=="string"?u:void 0)}return g.setSpanContext(e,s)}fields(){return[gt,ye]}};var js="[object Object]",Ks="[object Null]",zs="[object Undefined]",$s=Function.prototype,eo=$s.toString,Ys=eo.call(Object),Xs=Object.getPrototypeOf,ro=Object.prototype,no=ro.hasOwnProperty,ut=Symbol?Symbol.toStringTag:void 0,oo=ro.toString;function Er(t){if(!Ws(t)||qs(t)!==js)return!1;let e=Xs(t);if(e===null)return!0;let r=no.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&eo.call(r)===Ys}function Ws(t){return t!=null&&typeof t=="object"}function qs(t){return t==null?t===void 0?zs:Ks:ut&&ut in Object(t)?Qs(t):Js(t)}function Qs(t){let e=no.call(t,ut),r=t[ut],n=!1;try{t[ut]=void 0,n=!0}catch(i){}let o=oo.call(t);return n&&(e?t[ut]=r:delete t[ut]),o}function Js(t){return oo.call(t)}var Zs=20;function Sr(...t){let e=t.shift(),r=new WeakMap;for(;t.length>0;)e=so(e,t.shift(),0,r);return e}function gr(t){return Le(t)?t.slice():t}function so(t,e,r=0,n){let o;if(!(r>Zs)){if(r++,ve(t)||ve(e)||ao(e))o=gr(e);else if(Le(t)){if(o=t.slice(),Le(e))for(let i=0,s=e.length;i<s;i++)o.push(gr(e[i]));else if(jt(e)){let i=Object.keys(e);for(let s=0,a=i.length;s<a;s++){let u=i[s];o[u]=gr(e[u])}}}else if(jt(t))if(jt(e)){if(!ta(t,e))return e;o=Object.assign({},t);let i=Object.keys(e);for(let s=0,a=i.length;s<a;s++){let u=i[s],p=e[u];if(ve(p))typeof p=="undefined"?delete o[u]:o[u]=p;else{let l=o[u],f=p;if(io(t,u,n)||io(e,u,n))delete o[u];else{if(jt(l)&&jt(f)){let T=n.get(l)||[],h=n.get(f)||[];T.push({obj:t,key:u}),h.push({obj:e,key:u}),n.set(l,T),n.set(f,h)}o[u]=so(o[u],p,r,n)}}}}else o=e;return o}}function io(t,e,r){let n=r.get(t[e])||[];for(let o=0,i=n.length;o<i;o++){let s=n[o];if(s.key===e&&s.obj===t)return!0}return!1}function Le(t){return Array.isArray(t)}function ao(t){return typeof t=="function"}function jt(t){return!ve(t)&&!Le(t)&&!ao(t)&&typeof t=="object"}function ve(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="undefined"||t instanceof Date||t instanceof RegExp||t===null}function ta(t,e){return!(!Er(t)||!Er(e))}function Pe(t,e){return typeof e=="string"?t===e:!!t.match(e)}function Ar(t,e){if(!e)return!1;for(let r of e)if(Pe(t,r))return!0;return!1}var be=class{constructor(){c(this,"_promise");c(this,"_resolve");c(this,"_reject");this._promise=new Promise((e,r)=>{this._resolve=e,this._reject=r})}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}};var Kt=class{constructor(e,r){c(this,"_isCalled",!1);c(this,"_deferred",new be);c(this,"_callback");c(this,"_that");this._callback=e,this._that=r}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...e){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...e)).then(r=>this._deferred.resolve(r),r=>this._deferred.reject(r))}catch(r){this._deferred.reject(r)}}return this._deferred.promise}};var Ce;function co(){if(Ce===void 0)try{let t=globalThis.process.argv0;Ce=t?`unknown_service:${t}`:"unknown_service"}catch(t){Ce="unknown_service"}return Ce}var St=t=>t!==null&&typeof t=="object"&&typeof t.then=="function";var Rr=class t{constructor(e,r){c(this,"_rawAttributes");c(this,"_asyncAttributesPending",!1);c(this,"_schemaUrl");c(this,"_memoizedAttributes");var o;let n=(o=e.attributes)!=null?o:{};this._rawAttributes=Object.entries(n).map(([i,s])=>(St(s)&&(this._asyncAttributesPending=!0),[i,s])),this._rawAttributes=uo(this._rawAttributes),this._schemaUrl=ra(r==null?void 0:r.schemaUrl)}static FromAttributeList(e,r){let n=new t({},r);return n._rawAttributes=uo(e),n._asyncAttributesPending=e.filter(([o,i])=>St(i)).length>0,n}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let e=0;e<this._rawAttributes.length;e++){let[r,n]=this._rawAttributes[e];this._rawAttributes[e]=[r,St(n)?await n:n]}this._asyncAttributesPending=!1}}get attributes(){var r;if(this.asyncAttributesPending&&_.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;let e={};for(let[n,o]of this._rawAttributes){if(St(o)){_.debug(`Unsettled resource attribute ${n} skipped`);continue}o!=null&&((r=e[n])!=null||(e[n]=o))}return this._asyncAttributesPending||(this._memoizedAttributes=e),e}getRawAttributes(){return this._rawAttributes}get schemaUrl(){return this._schemaUrl}merge(e){if(e==null)return this;let r=na(this,e),n=r?{schemaUrl:r}:void 0;return t.FromAttributeList([...e.getRawAttributes(),...this.getRawAttributes()],n)}};function Ie(t,e){return Rr.FromAttributeList(Object.entries(t),e)}function xr(){return Ie({[zn]:co(),[Gt]:Et[Gt],[Ht]:Et[Ht],[Vt]:Et[Vt]})}function uo(t){return t.map(([e,r])=>St(r)?[e,r.catch(n=>{_.debug("promise rejection for resource attribute: %s - %s",e,n)})]:[e,r])}function ra(t){if(typeof t=="string"||t===void 0)return t;_.warn("Schema URL must be string or undefined, got %s. Schema URL will be ignored.",t)}function na(t,e){let r=t==null?void 0:t.schemaUrl,n=e==null?void 0:e.schemaUrl,o=r===void 0||r==="",i=n===void 0||n==="";if(o)return n;if(i||r===n)return r;_.warn('Schema URL merge conflict: old resource has "%s", updating resource has "%s". Resulting resource will have undefined Schema URL.',r,n)}var po="exception";var we=class{constructor(e){c(this,"_spanContext");c(this,"kind");c(this,"parentSpanContext");c(this,"attributes",{});c(this,"links",[]);c(this,"events",[]);c(this,"startTime");c(this,"resource");c(this,"instrumentationScope");c(this,"_droppedAttributesCount",0);c(this,"_droppedEventsCount",0);c(this,"_droppedLinksCount",0);c(this,"name");c(this,"status",{code:U.UNSET});c(this,"endTime",[0,0]);c(this,"_ended",!1);c(this,"_duration",[-1,-1]);c(this,"_spanProcessor");c(this,"_spanLimits");c(this,"_attributeValueLengthLimit");c(this,"_performanceStartTime");c(this,"_performanceOffset");c(this,"_startTimeProvided");var n;let r=Date.now();this._spanContext=e.spanContext,this._performanceStartTime=y.now(),this._performanceOffset=r-(this._performanceStartTime+y.timeOrigin),this._startTimeProvided=e.startTime!=null,this._spanLimits=e.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=e.spanProcessor,this.name=e.name,this.parentSpanContext=e.parentSpanContext,this.kind=e.kind,this.links=e.links||[],this.startTime=this._getTime((n=e.startTime)!=null?n:r),this.resource=e.resource,this.instrumentationScope=e.scope,e.attributes!=null&&this.setAttributes(e.attributes),this._spanProcessor.onStart(this,e.context)}spanContext(){return this._spanContext}setAttribute(e,r){if(r==null||this._isSpanEnded())return this;if(e.length===0)return _.warn(`Invalid attribute key: ${e}`),this;if(!ge(r))return _.warn(`Invalid attribute value set for key: ${e}`),this;let{attributeCountLimit:n}=this._spanLimits;return n!==void 0&&Object.keys(this.attributes).length>=n&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(r),this)}setAttributes(e){for(let[r,n]of Object.entries(e))this.setAttribute(r,n);return this}addEvent(e,r,n){if(this._isSpanEnded())return this;let{eventCountLimit:o}=this._spanLimits;if(o===0)return _.warn("No events allowed."),this._droppedEventsCount++,this;o!==void 0&&this.events.length>=o&&(this._droppedEventsCount===0&&_.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),xe(r)&&(xe(n)||(n=r),r=void 0);let i=at(r);return this.events.push({name:e,attributes:i,time:this._getTime(n),droppedAttributesCount:0}),this}addLink(e){return this.links.push(e),this}addLinks(e){return this.links.push(...e),this}setStatus(e){return this._isSpanEnded()?this:(this.status={...e},this.status.message!=null&&typeof e.message!="string"&&(_.warn(`Dropping invalid status.message of type '${typeof e.message}', expected 'string'`),delete this.status.message),this)}updateName(e){return this._isSpanEnded()?this:(this.name=e,this)}end(e){if(this._isSpanEnded()){_.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`);return}this.endTime=this._getTime(e),this._duration=Tr(this.startTime,this.endTime),this._duration[0]<0&&(_.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&_.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnding&&this._spanProcessor.onEnding(this),this._ended=!0,this._spanProcessor.onEnd(this)}_getTime(e){if(typeof e=="number"&&e<=y.now())return Y(e+this._performanceOffset);if(typeof e=="number")return B(e);if(e instanceof Date)return B(e.getTime());if(Bt(e))return e;if(this._startTimeProvided)return B(Date.now());let r=y.now()-this._performanceStartTime;return Oe(this.startTime,B(r))}isRecording(){return this._ended===!1}recordException(e,r){let n={};typeof e=="string"?n[Se]=e:e&&(e.code?n[Ae]=e.code.toString():e.name&&(n[Ae]=e.name),e.message&&(n[Se]=e.message),e.stack&&(n[Vn]=e.stack)),n[Ae]||n[Se]?this.addEvent(po,n,r):_.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){let e=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);_.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,e)}return this._ended}_truncateToLimitUtil(e,r){return e.length<=r?e:e.substring(0,r)}_truncateToSize(e){let r=this._attributeValueLengthLimit;return r<=0?(_.warn(`Attribute value limit must be positive, got ${r}`),e):typeof e=="string"?this._truncateToLimitUtil(e,r):Array.isArray(e)?e.map(n=>typeof n=="string"?this._truncateToLimitUtil(n,r):n):e}};var X;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(X||(X={}));var tt=class{shouldSample(){return{decision:X.NOT_RECORD}}toString(){return"AlwaysOffSampler"}};var k=class{shouldSample(){return{decision:X.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}};var pt=class{constructor(e){c(this,"_root");c(this,"_remoteParentSampled");c(this,"_remoteParentNotSampled");c(this,"_localParentSampled");c(this,"_localParentNotSampled");var r,n,o,i;this._root=e.root,this._root||(G(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new k),this._remoteParentSampled=(r=e.remoteParentSampled)!=null?r:new k,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!=null?n:new tt,this._localParentSampled=(o=e.localParentSampled)!=null?o:new k,this._localParentNotSampled=(i=e.localParentNotSampled)!=null?i:new tt}shouldSample(e,r,n,o,i,s){let a=g.getSpanContext(e);return!a||!$(a)?this._root.shouldSample(e,r,n,o,i,s):a.isRemote?a.traceFlags&P.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,i,s):this._remoteParentNotSampled.shouldSample(e,r,n,o,i,s):a.traceFlags&P.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,i,s):this._localParentNotSampled.shouldSample(e,r,n,o,i,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}};var zt=class{constructor(e=0){c(this,"_ratio");c(this,"_upperBound");this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(e,r){return{decision:me(r)&&this._accumulate(r)<this._upperBound?X.RECORD_AND_SAMPLED:X.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let r=0;for(let n=0;n<e.length/8;n++){let o=n*8,i=parseInt(e.slice(o,o+8),16);r=(r^i)>>>0}return r}};var F;(function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})(F||(F={}));var De=1;function Me(){var t,e,r,n,o,i,s,a;return{sampler:Or(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:(t=void 0)!=null?t:1/0,attributeCountLimit:(e=void 0)!=null?e:128},spanLimits:{attributeValueLengthLimit:(r=void 0)!=null?r:1/0,attributeCountLimit:(n=void 0)!=null?n:128,linkCountLimit:(o=void 0)!=null?o:128,eventCountLimit:(i=void 0)!=null?i:128,attributePerEventCountLimit:(s=void 0)!=null?s:128,attributePerLinkCountLimit:(a=void 0)!=null?a:128}}}function Or(){var e;let t=(e=void 0)!=null?e:F.ParentBasedAlwaysOn;switch(t){case F.AlwaysOn:return new k;case F.AlwaysOff:return new tt;case F.ParentBasedAlwaysOn:return new pt({root:new k});case F.ParentBasedAlwaysOff:return new pt({root:new tt});case F.TraceIdRatio:return new zt(lo());case F.ParentBasedTraceIdRatio:return new pt({root:new zt(lo())});default:return _.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "${F.ParentBasedAlwaysOn}".`),new pt({root:new k})}}function lo(){let t=void 0;return t==null?(_.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${De}.`),De):t<0||t>1?(_.error(`OTEL_TRACES_SAMPLER_ARG=${t} was given, but it is out of range ([0..1]), defaulting to ${De}.`),De):t}var oa=128,ia=1/0;function _o(t){let e={sampler:Or()},r=Me(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}function fo(t){var r,n,o,i,s,a,u,p,l,f,T,h;let e=Object.assign({},t.spanLimits);return e.attributeCountLimit=(a=(s=(i=(o=(r=t.spanLimits)==null?void 0:r.attributeCountLimit)!=null?o:(n=t.generalLimits)==null?void 0:n.attributeCountLimit)!=null?i:void 0)!=null?s:void 0)!=null?a:oa,e.attributeValueLengthLimit=(h=(T=(f=(l=(u=t.spanLimits)==null?void 0:u.attributeValueLengthLimit)!=null?l:(p=t.generalLimits)==null?void 0:p.attributeValueLengthLimit)!=null?f:void 0)!=null?T:void 0)!=null?h:ia,Object.assign({},t,{spanLimits:e})}var Ue=class{constructor(e,r){c(this,"_maxExportBatchSize");c(this,"_maxQueueSize");c(this,"_scheduledDelayMillis");c(this,"_exportTimeoutMillis");c(this,"_exporter");c(this,"_isExporting",!1);c(this,"_finishedSpans",[]);c(this,"_timer");c(this,"_shutdownOnce");c(this,"_droppedSpansCount",0);var n,o,i,s;this._exporter=e,this._maxExportBatchSize=typeof(r==null?void 0:r.maxExportBatchSize)=="number"?r.maxExportBatchSize:(n=void 0)!=null?n:512,this._maxQueueSize=typeof(r==null?void 0:r.maxQueueSize)=="number"?r.maxQueueSize:(o=void 0)!=null?o:2048,this._scheduledDelayMillis=typeof(r==null?void 0:r.scheduledDelayMillis)=="number"?r.scheduledDelayMillis:(i=void 0)!=null?i:5e3,this._exportTimeoutMillis=typeof(r==null?void 0:r.exportTimeoutMillis)=="number"?r.exportTimeoutMillis:(s=void 0)!=null?s:3e4,this._shutdownOnce=new Kt(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(_.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(e,r){}onEnd(e){this._shutdownOnce.isCalled||(e.spanContext().traceFlags&P.SAMPLED)!==0&&this._addToBuffer(e)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&_.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(_.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()}_flushAll(){return new Promise((e,r)=>{let n=[],o=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let i=0,s=o;i<s;i++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{e()}).catch(r)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((e,r)=>{let n=setTimeout(()=>{r(new Error("Timeout"))},this._exportTimeoutMillis);E.with(fr(E.active()),()=>{let o;this._finishedSpans.length<=this._maxExportBatchSize?(o=this._finishedSpans,this._finishedSpans=[]):o=this._finishedSpans.splice(0,this._maxExportBatchSize);let i=()=>this._exporter.export(o,a=>{var u;clearTimeout(n),a.code===w.SUCCESS?e():r((u=a.error)!=null?u:new Error("BatchSpanProcessor: span export failed"))}),s=null;for(let a=0,u=o.length;a<u;a++){let p=o[a];p.resource.asyncAttributesPending&&p.resource.waitForAsyncAttributes&&(s!=null||(s=[]),s.push(p.resource.waitForAsyncAttributes()))}s===null?i():Promise.all(s).then(i,a=>{G(a),r(a)})})})}_maybeStartTimer(){if(this._isExporting)return;let e=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(r=>{this._isExporting=!1,G(r)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return e();this._timer===void 0&&(this._timer=setTimeout(()=>e(),this._scheduledDelayMillis),typeof this._timer!="number"&&this._timer.unref())}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}};var At=class extends Ue{constructor(r,n){super(r,n);c(this,"_visibilityChangeListener");c(this,"_pageHideListener");this.onInit(n)}onInit(r){(r==null?void 0:r.disableAutoFlushOnDocumentHide)!==!0&&typeof document!="undefined"&&(this._visibilityChangeListener=()=>{document.visibilityState==="hidden"&&this.forceFlush().catch(n=>{G(n)})},this._pageHideListener=()=>{this.forceFlush().catch(n=>{G(n)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){typeof document!="undefined"&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}};var Rt=class{constructor(){c(this,"generateTraceId",mo(16));c(this,"generateSpanId",mo(8))}},Ge=Array(32);function mo(t){return function(){for(let r=0;r<t*2;r++)Ge[r]=Math.floor(Math.random()*16)+48,Ge[r]>=58&&(Ge[r]+=39);return String.fromCharCode.apply(null,Ge.slice(0,t*2))}}var He=class{constructor(e,r,n,o){c(this,"_sampler");c(this,"_generalLimits");c(this,"_spanLimits");c(this,"_idGenerator");c(this,"instrumentationScope");c(this,"_resource");c(this,"_spanProcessor");let i=_o(r);this._sampler=i.sampler,this._generalLimits=i.generalLimits,this._spanLimits=i.spanLimits,this._idGenerator=r.idGenerator||new Rt,this._resource=n,this._spanProcessor=o,this.instrumentationScope=e}startSpan(e,r={},n=E.active()){var vt,Lt,Pt;r.root&&(n=g.deleteSpan(n));let o=g.getSpan(n);if(st(n))return _.debug("Instrumentation suppressed, returning Noop Span"),g.wrapSpanContext(wt);let i=o==null?void 0:o.spanContext(),s=this._idGenerator.generateSpanId(),a,u,p;!i||!g.isSpanContextValid(i)?u=this._idGenerator.generateTraceId():(u=i.traceId,p=i.traceState,a=i);let l=(vt=r.kind)!=null?vt:it.INTERNAL,f=((Lt=r.links)!=null?Lt:[]).map(mt=>({context:mt.context,attributes:at(mt.attributes)})),T=at(r.attributes),h=this._sampler.shouldSample(n,u,e,l,T,f);p=(Pt=h.traceState)!=null?Pt:p;let d=h.decision===Tt.RECORD_AND_SAMPLED?P.SAMPLED:P.NONE,S={traceId:u,spanId:s,traceFlags:d,traceState:p};if(h.decision===Tt.NOT_RECORD)return _.debug("Recording is off, propagating context in a non-recording span"),g.wrapSpanContext(S);let N=at(Object.assign(T,h.attributes));return new we({resource:this._resource,scope:this.instrumentationScope,context:n,spanContext:S,name:e,kind:l,links:f,parentSpanContext:a,attributes:N,startTime:r.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(e,r,n,o){let i,s,a;if(arguments.length<2)return;arguments.length===2?a=r:arguments.length===3?(i=r,a=n):(i=r,s=n,a=o);let u=s!=null?s:E.active(),p=this.startSpan(e,i,u),l=g.setSpan(u,p);return E.with(l,a,void 0,p)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}};var Ve=class{constructor(e){c(this,"_spanProcessors");this._spanProcessors=e}forceFlush(){let e=[];for(let r of this._spanProcessors)e.push(r.forceFlush());return new Promise(r=>{Promise.all(e).then(()=>{r()}).catch(n=>{G(n||new Error("MultiSpanProcessor: forceFlush failed")),r()})})}onStart(e,r){for(let n of this._spanProcessors)n.onStart(e,r)}onEnding(e){for(let r of this._spanProcessors)r.onEnding&&r.onEnding(e)}onEnd(e){for(let r of this._spanProcessors)r.onEnd(e)}shutdown(){let e=[];for(let r of this._spanProcessors)e.push(r.shutdown());return new Promise((r,n)=>{Promise.all(e).then(()=>{r()},n)})}};var lt;(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(lt||(lt={}));var $t=class{constructor(e={}){c(this,"_config");c(this,"_tracers",new Map);c(this,"_resource");c(this,"_activeSpanProcessor");var o,i;let r=Sr({},Me(),fo(e));this._resource=(o=r.resource)!=null?o:xr(),this._config=Object.assign({},r,{resource:this._resource});let n=[];(i=e.spanProcessors)!=null&&i.length&&n.push(...e.spanProcessors),this._activeSpanProcessor=new Ve(n)}getTracer(e,r,n){let o=`${e}@${r||""}:${(n==null?void 0:n.schemaUrl)||""}`;return this._tracers.has(o)||this._tracers.set(o,new He({name:e,version:r,schemaUrl:n==null?void 0:n.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(o)}forceFlush(){let e=this._config.forceFlushTimeoutMillis,r=this._activeSpanProcessor._spanProcessors.map(n=>new Promise(o=>{let i,s=setTimeout(()=>{o(new Error(`Span processor did not completed within timeout period of ${e} ms`)),i=lt.timeout},e);n.forceFlush().then(()=>{clearTimeout(s),i!==lt.timeout&&(i=lt.resolved,o(i))}).catch(a=>{clearTimeout(s),i=lt.error,o(a)})}));return new Promise((n,o)=>{Promise.all(r).then(i=>{let s=i.filter(a=>a!==lt.resolved);s.length>0?o(s):n()}).catch(i=>o([i]))})}shutdown(){return this._activeSpanProcessor.shutdown()}};var Be=class{constructor(){c(this,"_enabled",!1);c(this,"_currentContext",M)}_bindFunction(e=M,r){let n=this,o=function(...i){return n.with(e,()=>r.apply(this,i))};return Object.defineProperty(o,"length",{enumerable:!1,configurable:!0,writable:!1,value:r.length}),o}active(){return this._currentContext}bind(e,r){return e===void 0&&(e=this.active()),typeof r=="function"?this._bindFunction(e,r):r}disable(){return this._currentContext=M,this._enabled=!1,this}enable(){return this._enabled?this:(this._enabled=!0,this._currentContext=M,this)}with(e,r,n,...o){let i=this._currentContext;this._currentContext=e||M;try{return r.call(n,...o)}finally{this._currentContext=i}}};function sa(t){if(t!==null){if(t===void 0){let e=new Be;e.enable(),E.setGlobalContextManager(e);return}t.enable(),E.setGlobalContextManager(t)}}function aa(t){if(t!==null){if(t===void 0){I.setGlobalPropagator(new kt({propagators:[new Ft,new Ut]}));return}I.setGlobalPropagator(t)}}var Yt=class extends $t{constructor(e={}){super(e)}register(e={}){g.setGlobalTracerProvider(this),aa(e.propagator),sa(e.contextManager)}};var m;(function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"})(m||(m={}));var To="http.response_content_length",ho="http.response_content_length_uncompressed";var Nr;function ca(){return Nr||(Nr=document.createElement("a")),Nr}function W(t,e){return e in t}function x(t,e,r,n=!0){if(W(r,e)&&typeof r[e]=="number"&&!(n&&r[e]===0))return t.addEvent(e,r[e])}function _t(t,e,r=!1,n,o){if(n===void 0&&(n=e[m.START_TIME]!==0),r||(x(t,m.FETCH_START,e,n),x(t,m.DOMAIN_LOOKUP_START,e,n),x(t,m.DOMAIN_LOOKUP_END,e,n),x(t,m.CONNECT_START,e,n),x(t,m.SECURE_CONNECTION_START,e,n),x(t,m.CONNECT_END,e,n),x(t,m.REQUEST_START,e,n),x(t,m.RESPONSE_START,e,n),x(t,m.RESPONSE_END,e,n)),!o){let i=e[m.ENCODED_BODY_SIZE];i!==void 0&&t.setAttribute(To,i);let s=e[m.DECODED_BODY_SIZE];s!==void 0&&i!==s&&t.setAttribute(ho,s)}}function Eo(t){return t.slice().sort((e,r)=>{let n=e[m.FETCH_START],o=r[m.FETCH_START];return n>o?1:n<o?-1:0})}function go(){return typeof location!="undefined"?location.origin:void 0}function yr(t,e,r,n,o=new WeakSet,i){let s=q(t);t=s.toString();let a=pa(t,e,r,n,o,i);if(a.length===0)return{mainRequest:void 0};if(a.length===1)return{mainRequest:a[0]};let u=Eo(a);if(s.origin!==go()&&u.length>1){let p=u[0],l=ua(u,p[m.RESPONSE_END],r),f=p[m.RESPONSE_END];return l[m.FETCH_START]<f&&(l=p,p=void 0),{corsPreFlightRequest:p,mainRequest:l}}else return{mainRequest:a[0]}}function ua(t,e,r){let n=D(r),o=D(ct(e)),i=t[1],s,a=t.length;for(let u=1;u<a;u++){let p=t[u],l=D(ct(p[m.FETCH_START])),f=D(ct(p[m.RESPONSE_END])),T=n-f;l>=o&&(!s||T<s)&&(s=T,i=p)}return i}function pa(t,e,r,n,o,i){let s=D(e),a=D(r),u=n.filter(p=>{let l=D(ct(p[m.FETCH_START])),f=D(ct(p[m.RESPONSE_END]));return p.initiatorType.toLowerCase()===(i||"xmlhttprequest")&&p.name===t&&l>=s&&f<=a});return u.length>0&&(u=u.filter(p=>!o.has(p))),u}function q(t){if(typeof URL=="function")return new URL(t,typeof document!="undefined"?document.baseURI:typeof location!="undefined"?location.href:void 0);let e=ca();return e.href=t,e}function ke(t,e){if(t.nodeType===Node.DOCUMENT_NODE)return"/";let r=_a(t,e);if(e&&r.indexOf("@id")>0)return r;let n="";return t.parentNode&&(n+=ke(t.parentNode,!1)),n+=r,n}function la(t){if(!t.parentNode)return 0;let e=[t.nodeType];t.nodeType===Node.CDATA_SECTION_NODE&&e.push(Node.TEXT_NODE);let r=Array.from(t.parentNode.childNodes);return r=r.filter(n=>{let o=n.localName;return e.indexOf(n.nodeType)>=0&&o===t.localName}),r.length>=1?r.indexOf(t)+1:0}function _a(t,e){let r=t.nodeType,n=la(t),o="";if(r===Node.ELEMENT_NODE){let i=t.getAttribute("id");if(e&&i)return`//*[@id="${i}"]`;o=t.localName}else if(r===Node.TEXT_NODE||r===Node.CDATA_SECTION_NODE)o="text()";else if(r===Node.COMMENT_NODE)o="comment()";else return"";return o&&n>1?`/${o}[${n}]`:`/${o}`}function vr(t,e){let r=e||[];return(typeof r=="string"||r instanceof RegExp)&&(r=[r]),q(t).origin===go()?!0:r.some(o=>Pe(t,o))}var Xt=class{emit(e){}},So=new Xt;var Wt=Symbol.for("io.opentelemetry.js.api.logs"),xt=globalThis;function Ao(t,e,r){return n=>n===t?e:r}var Lr=1;var Pr=class{getLogger(e,r,n){return new Xt}},Fe=new Pr;var je=class{constructor(e,r,n,o){this._provider=e,this.name=r,this.version=n,this.options=o}emit(e){this._getLogger().emit(e)}_getLogger(){if(this._delegate)return this._delegate;let e=this._provider._getDelegateLogger(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):So}};var qt=class{getLogger(e,r,n){var o;return(o=this._getDelegateLogger(e,r,n))!==null&&o!==void 0?o:new je(this,e,r,n)}_getDelegate(){var e;return(e=this._delegate)!==null&&e!==void 0?e:Fe}_setDelegate(e){this._delegate=e}_getDelegateLogger(e,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getLogger(e,r,n)}};var Ke=class t{constructor(){this._proxyLoggerProvider=new qt}static getInstance(){return this._instance||(this._instance=new t),this._instance}setGlobalLoggerProvider(e){return xt[Wt]?this.getLoggerProvider():(xt[Wt]=Ao(Lr,e,Fe),this._proxyLoggerProvider._setDelegate(e),e)}getLoggerProvider(){var e,r;return(r=(e=xt[Wt])===null||e===void 0?void 0:e.call(xt,Lr))!==null&&r!==void 0?r:this._proxyLoggerProvider}getLogger(e,r,n){return this.getLoggerProvider().getLogger(e,r,n)}disable(){delete xt[Wt],this._proxyLoggerProvider=new qt}};var ze=Ke.getInstance();function Ro(t,e,r,n){for(let o=0,i=t.length;o<i;o++){let s=t[o];e&&s.setTracerProvider(e),r&&s.setMeterProvider(r),n&&s.setLoggerProvider&&s.setLoggerProvider(n),s.getConfig().enabled||s.enable()}}function xo(t){t.forEach(e=>e.disable())}function br(t){var i,s;let e=t.tracerProvider||g.getTracerProvider(),r=t.meterProvider||Mt.getMeterProvider(),n=t.loggerProvider||ze.getLoggerProvider(),o=(s=(i=t.instrumentations)==null?void 0:i.flat())!=null?s:[];return Ro(o,e,r,n),()=>{xo(o)}}var b=console.error.bind(console);function Qt(t,e,r){let n=!!t[e]&&Object.prototype.propertyIsEnumerable.call(t,e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}var $e=(t,e,r)=>{if(!t||!t[e]){b("no original function "+String(e)+" to wrap");return}if(!r){b("no wrapper function"),b(new Error().stack);return}let n=t[e];if(typeof n!="function"||typeof r!="function"){b("original object and wrapper must be functions");return}let o=r(n,e);return Qt(o,"__original",n),Qt(o,"__unwrap",()=>{t[e]===o&&Qt(t,e,n)}),Qt(o,"__wrapped",!0),Qt(t,e,o),o},Cr=(t,e,r)=>{if(t)Array.isArray(t)||(t=[t]);else{b("must provide one or more modules to patch"),b(new Error().stack);return}if(!(e&&Array.isArray(e))){b("must provide one or more functions to wrap on modules");return}t.forEach(n=>{e.forEach(o=>{$e(n,o,r)})})},Ye=(t,e)=>{if(!t||!t[e]){b("no function to unwrap."),b(new Error().stack);return}let r=t[e];if(!r.__unwrap)b("no original to unwrap to -- has "+String(e)+" already been unwrapped?");else{r.__unwrap();return}},Ir=(t,e)=>{if(t)Array.isArray(t)||(t=[t]);else{b("must provide one or more modules to patch"),b(new Error().stack);return}if(!(e&&Array.isArray(e))){b("must provide one or more functions to unwrap on modules");return}t.forEach(r=>{e.forEach(n=>{Ye(r,n)})})};function Jt(t){t&&t.logger&&(typeof t.logger!="function"?b("new logger isn't a function, not replacing"):b=t.logger)}Jt.wrap=$e;Jt.massWrap=Cr;Jt.unwrap=Ye;Jt.massUnwrap=Ir;var Xe=class{constructor(e,r,n){c(this,"_config",{});c(this,"_tracer");c(this,"_meter");c(this,"_logger");c(this,"_diag");c(this,"instrumentationName");c(this,"instrumentationVersion");c(this,"_wrap",$e);c(this,"_unwrap",Ye);c(this,"_massWrap",Cr);c(this,"_massUnwrap",Ir);this.instrumentationName=e,this.instrumentationVersion=r,this.setConfig(n),this._diag=_.createComponentLogger({namespace:e}),this._tracer=g.getTracer(e,r),this._meter=Mt.getMeter(e,r),this._logger=ze.getLogger(e,r),this._updateMetricInstruments()}get meter(){return this._meter}setMeterProvider(e){this._meter=e.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(e){this._logger=e.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){var r;let e=(r=this.init())!=null?r:[];return Array.isArray(e)?e:[e]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(e){this._config={enabled:!0,...e}}setTracerProvider(e){this._tracer=e.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(e,r,n,o){if(e)try{e(n,o)}catch(i){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:r},i)}}};var j=class extends Xe{constructor(e,r,n){super(e,r,n),this._config.enabled&&this.enable()}};function Ot(t,e,r){let n,o;try{o=t()}catch(i){n=i}finally{if(e(n,o),n&&!r)throw n;return o}}function O(t){return typeof t=="function"&&typeof t.__original=="function"&&typeof t.__unwrap=="function"&&t.__wrapped===!0}var R;(function(t){t[t.STABLE=1]="STABLE",t[t.OLD=2]="OLD",t[t.DUPLICATE=3]="DUPLICATE"})(R||(R={}));function Zt(t,e){let r=R.OLD,n=e==null?void 0:e.split(",").map(o=>o.trim()).filter(o=>o!=="");for(let o of n!=null?n:[])if(o.toLowerCase()===t+"/dup"){r=R.DUPLICATE;break}else o.toLowerCase()===t&&(r=R.STABLE);return r}var ft;(function(t){t.DOCUMENT_LOAD="documentLoad",t.DOCUMENT_FETCH="documentFetch",t.RESOURCE_FETCH="resourceFetch"})(ft||(ft={}));var Oo="0.56.0",No="@opentelemetry/instrumentation-document-load";var We="http.url",yo="http.user_agent";var te;(function(t){t.FIRST_PAINT="firstPaint",t.FIRST_CONTENTFUL_PAINT="firstContentfulPaint"})(te||(te={}));var Lo=()=>{var r,n;let t={},e=(n=(r=y).getEntriesByType)==null?void 0:n.call(r,"navigation")[0];if(e)Object.values(m).forEach(i=>{if(W(e,i)){let s=e[i];typeof s=="number"&&(t[i]=s)}});else{let i=y.timing;i&&Object.values(m).forEach(a=>{if(W(i,a)){let u=i[a];typeof u=="number"&&(t[a]=u)}})}return t},vo={"first-paint":te.FIRST_PAINT,"first-contentful-paint":te.FIRST_CONTENTFUL_PAINT},Po=t=>{var r,n;let e=(n=(r=y).getEntriesByType)==null?void 0:n.call(r,"paint");e&&e.forEach(({name:o,startTime:i})=>{W(vo,o)&&t.addEvent(vo[o],i)})};var ee=class extends j{constructor(r={}){super(No,Oo,r);c(this,"component","document-load");c(this,"version","1");c(this,"moduleName",this.component);c(this,"_semconvStability");this._semconvStability=Zt("http",r==null?void 0:r.semconvStabilityOptIn)}init(){}_onDocumentLoaded(){window.setTimeout(()=>{this._collectPerformance()})}_addResourcesSpans(r){var o,i;let n=(i=(o=y).getEntriesByType)==null?void 0:i.call(o,"resource");n&&n.forEach(s=>{this._initResourceSpan(s,r)})}_collectPerformance(){let r=Array.from(document.getElementsByTagName("meta")).find(i=>i.getAttribute("name")===gt),n=Lo(),o=r&&r.content||"";E.with(I.extract(M,{traceparent:o}),()=>{var s;let i=this._startSpan(ft.DOCUMENT_LOAD,m.FETCH_START,n);i&&(E.with(g.setSpan(E.active(),i),()=>{let a=this._startSpan(ft.DOCUMENT_FETCH,m.FETCH_START,n);a&&(this._semconvStability&R.OLD&&a.setAttribute(We,location.href),this._semconvStability&R.STABLE&&a.setAttribute(ht,location.href),E.with(g.setSpan(E.active(),a),()=>{var p;let u=!(this._semconvStability&R.OLD);_t(a,n,this.getConfig().ignoreNetworkEvents,void 0,u),this._addCustomAttributesOnSpan(a,(p=this.getConfig().applyCustomAttributesOnSpan)==null?void 0:p.documentFetch),this._endSpan(a,m.RESPONSE_END,n)}))}),this._semconvStability&R.OLD&&(i.setAttribute(We,location.href),i.setAttribute(yo,navigator.userAgent)),this._semconvStability&R.STABLE&&(i.setAttribute(ht,location.href),i.setAttribute(Yn,navigator.userAgent)),this._addResourcesSpans(i),this.getConfig().ignoreNetworkEvents||(x(i,m.FETCH_START,n),x(i,m.UNLOAD_EVENT_START,n),x(i,m.UNLOAD_EVENT_END,n),x(i,m.DOM_INTERACTIVE,n),x(i,m.DOM_CONTENT_LOADED_EVENT_START,n),x(i,m.DOM_CONTENT_LOADED_EVENT_END,n),x(i,m.DOM_COMPLETE,n),x(i,m.LOAD_EVENT_START,n),x(i,m.LOAD_EVENT_END,n)),this.getConfig().ignorePerformancePaintEvents||Po(i),this._addCustomAttributesOnSpan(i,(s=this.getConfig().applyCustomAttributesOnSpan)==null?void 0:s.documentLoad),this._endSpan(i,m.LOAD_EVENT_END,n))})}_endSpan(r,n,o){r&&(W(o,n)?r.end(o[n]):r.end())}_initResourceSpan(r,n){var i;let o=this._startSpan(ft.RESOURCE_FETCH,m.FETCH_START,r,n);if(o){this._semconvStability&R.OLD&&o.setAttribute(We,r.name),this._semconvStability&R.STABLE&&o.setAttribute(ht,r.name);let s=!(this._semconvStability&R.OLD);_t(o,r,this.getConfig().ignoreNetworkEvents,void 0,s),this._addCustomAttributesOnResourceSpan(o,r,(i=this.getConfig().applyCustomAttributesOnSpan)==null?void 0:i.resourceFetch),this._endSpan(o,m.RESPONSE_END,r)}}_startSpan(r,n,o,i){if(W(o,n)&&typeof o[n]=="number")return this.tracer.startSpan(r,{startTime:o[n]},i?g.setSpan(E.active(),i):void 0)}_waitForPageLoad(){window.document.readyState==="complete"?this._onDocumentLoaded():(this._onDocumentLoaded=this._onDocumentLoaded.bind(this),window.addEventListener("load",this._onDocumentLoaded))}_addCustomAttributesOnSpan(r,n){n&&Ot(()=>n(r),o=>{o&&this._diag.error("addCustomAttributesOnSpan",o)},!0)}_addCustomAttributesOnResourceSpan(r,n,o){o&&Ot(()=>o(r,n),i=>{i&&this._diag.error("addCustomAttributesOnResourceSpan",i)},!0)}enable(){window.removeEventListener("load",this._onDocumentLoaded),this._waitForPageLoad()}disable(){window.removeEventListener("load",this._onDocumentLoaded)}};var dt;(function(t){t.EVENT_TYPE="event_type",t.TARGET_ELEMENT="target_element",t.TARGET_XPATH="target_xpath",t.HTTP_URL="http.url"})(dt||(dt={}));var wr="0.55.0",bo="@opentelemetry/instrumentation-user-interaction";var da="OT_ZONE_CONTEXT",ma="Navigation:",Ta=["click"];function ha(){return!1}var re=class extends j{constructor(r={}){var n;super(bo,wr,r);c(this,"version",wr);c(this,"moduleName","user-interaction");c(this,"_spansData",new WeakMap);c(this,"_wrappedListeners",new WeakMap);c(this,"_eventsSpanMap",new WeakMap);c(this,"_eventNames");c(this,"_shouldPreventSpanCreation");this._eventNames=new Set((n=r==null?void 0:r.eventNames)!=null?n:Ta),this._shouldPreventSpanCreation=typeof(r==null?void 0:r.shouldPreventSpanCreation)=="function"?r.shouldPreventSpanCreation:ha}init(){}_checkForTimeout(r,n){let o=this._spansData.get(n);o&&(r.source==="setTimeout"?o.hrTimeLastTimeout=Y():r.source!=="Promise.then"&&r.source!=="setTimeout"&&(o.hrTimeLastTimeout=void 0))}_allowEventName(r){return this._eventNames.has(r)}_createSpan(r,n,o){if(!(r instanceof HTMLElement)||!r.getAttribute||r.hasAttribute("disabled")||!this._allowEventName(n))return;let i=ke(r,!0);try{let s=this.tracer.startSpan(n,{attributes:{[dt.EVENT_TYPE]:n,[dt.TARGET_ELEMENT]:r.tagName,[dt.TARGET_XPATH]:i,[dt.HTTP_URL]:window.location.href}},o?g.setSpan(E.active(),o):void 0);return this._shouldPreventSpanCreation(n,r,s)===!0?void 0:(this._spansData.set(s,{taskCount:0}),s)}catch(s){this._diag.error("failed to start create new user interaction span",s)}}_decrementTask(r){let n=this._spansData.get(r);n&&(n.taskCount--,n.taskCount===0&&this._tryToEndSpan(r,n.hrTimeLastTimeout))}_getCurrentSpan(r){let n=r.get(da);return n&&g.getSpan(n)}_incrementTask(r){let n=this._spansData.get(r);n&&n.taskCount++}addPatchedListener(r,n,o,i){let s=this._wrappedListeners.get(o);s||(s=new Map,this._wrappedListeners.set(o,s));let a=s.get(n);return a||(a=new Map,s.set(n,a)),a.has(r)?!1:(a.set(r,i),!0)}removePatchedListener(r,n,o){let i=this._wrappedListeners.get(o);if(!i)return;let s=i.get(n);if(!s)return;let a=s.get(r);return a&&(s.delete(r),s.size===0&&(i.delete(n),i.size===0&&this._wrappedListeners.delete(o))),a}_invokeListener(r,n,o){return typeof r=="function"?r.apply(n,o):r.handleEvent(o[0])}_patchAddEventListener(){let r=this;return n=>function(i,s,a){if(!s)return n.call(this,i,s,a);let u=a&&typeof a=="object"&&a.once,p=function(...l){let f,T=l[0],h=T==null?void 0:T.target;T&&(f=r._eventsSpanMap.get(T)),u&&r.removePatchedListener(this,i,s);let d=r._createSpan(h,i,f);return d?(T&&r._eventsSpanMap.set(T,d),E.with(g.setSpan(E.active(),d),()=>{let S=r._invokeListener(s,this,l);return d.end(),S})):r._invokeListener(s,this,l)};if(r.addPatchedListener(this,i,s,p))return n.call(this,i,p,a)}}_patchRemoveEventListener(){let r=this;return n=>function(i,s,a){let u=r.removePatchedListener(this,i,s);return u?n.call(this,i,u,a):n.call(this,i,s,a)}}_getPatchableEventTargets(){return window.EventTarget?[EventTarget.prototype]:[Node.prototype,Window.prototype]}_patchHistoryApi(){this._unpatchHistoryApi(),this._wrap(history,"replaceState",this._patchHistoryMethod()),this._wrap(history,"pushState",this._patchHistoryMethod()),this._wrap(history,"back",this._patchHistoryMethod()),this._wrap(history,"forward",this._patchHistoryMethod()),this._wrap(history,"go",this._patchHistoryMethod())}_patchHistoryMethod(){let r=this;return n=>function(...i){let s=`${location.pathname}${location.hash}${location.search}`,a=n.apply(this,i),u=`${location.pathname}${location.hash}${location.search}`;return s!==u&&r._updateInteractionName(u),a}}_unpatchHistoryApi(){O(history.replaceState)&&this._unwrap(history,"replaceState"),O(history.pushState)&&this._unwrap(history,"pushState"),O(history.back)&&this._unwrap(history,"back"),O(history.forward)&&this._unwrap(history,"forward"),O(history.go)&&this._unwrap(history,"go")}_updateInteractionName(r){let n=g.getSpan(E.active());n&&typeof n.updateName=="function"&&n.updateName(`${ma} ${r}`)}_patchZoneCancelTask(){let r=this;return n=>function(i){let s=Zone.current,a=r._getCurrentSpan(s);return a&&r._shouldCountTask(i,s)&&r._decrementTask(a),n.call(this,i)}}_patchZoneScheduleTask(){let r=this;return n=>function(i){let s=Zone.current,a=r._getCurrentSpan(s);return a&&r._shouldCountTask(i,s)&&(r._incrementTask(a),r._checkForTimeout(i,a)),n.call(this,i)}}_patchZoneRunTask(){let r=this;return n=>function(i,s,a){let u=Array.isArray(a)&&a[0]instanceof Event?a[0]:void 0,p=u==null?void 0:u.target,l,f=this;if(p){if(l=r._createSpan(p,i.eventName),l)return r._incrementTask(l),f.run(()=>{try{return E.with(g.setSpan(E.active(),l),()=>{let T=Zone.current;return i._zone=T,n.call(T,i,s,a)})}finally{r._decrementTask(l)}})}else l=r._getCurrentSpan(f);try{return n.call(f,i,s,a)}finally{l&&r._shouldCountTask(i,f)&&r._decrementTask(l)}}}_shouldCountTask(r,n){if(r._zone&&(n=r._zone),!n||!r.data||r.data.isPeriodic)return!1;let o=this._getCurrentSpan(n);return!o||!this._spansData.get(o)?!1:r.type==="macroTask"||r.type==="microTask"}_tryToEndSpan(r,n){r&&this._spansData.get(r)&&(r.end(n),this._spansData.delete(r))}enable(){let r=this._getZoneWithPrototype();this._diag.debug("applying patch to",this.moduleName,this.version,"zone:",!!r),r?(O(r.prototype.runTask)&&(this._unwrap(r.prototype,"runTask"),this._diag.debug("removing previous patch from method runTask")),O(r.prototype.scheduleTask)&&(this._unwrap(r.prototype,"scheduleTask"),this._diag.debug("removing previous patch from method scheduleTask")),O(r.prototype.cancelTask)&&(this._unwrap(r.prototype,"cancelTask"),this._diag.debug("removing previous patch from method cancelTask")),this._zonePatched=!0,this._wrap(r.prototype,"runTask",this._patchZoneRunTask()),this._wrap(r.prototype,"scheduleTask",this._patchZoneScheduleTask()),this._wrap(r.prototype,"cancelTask",this._patchZoneCancelTask())):(this._zonePatched=!1,this._getPatchableEventTargets().forEach(o=>{O(o.addEventListener)&&(this._unwrap(o,"addEventListener"),this._diag.debug("removing previous patch from method addEventListener")),O(o.removeEventListener)&&(this._unwrap(o,"removeEventListener"),this._diag.debug("removing previous patch from method removeEventListener")),this._wrap(o,"addEventListener",this._patchAddEventListener()),this._wrap(o,"removeEventListener",this._patchRemoveEventListener())})),this._patchHistoryApi()}disable(){let r=this._getZoneWithPrototype();this._diag.debug("removing patch from",this.moduleName,this.version,"zone:",!!r),r&&this._zonePatched?(O(r.prototype.runTask)&&this._unwrap(r.prototype,"runTask"),O(r.prototype.scheduleTask)&&this._unwrap(r.prototype,"scheduleTask"),O(r.prototype.cancelTask)&&this._unwrap(r.prototype,"cancelTask")):this._getPatchableEventTargets().forEach(o=>{O(o.addEventListener)&&this._unwrap(o,"addEventListener"),O(o.removeEventListener)&&this._unwrap(o,"removeEventListener")}),this._unpatchHistoryApi()}_getZoneWithPrototype(){return window.Zone}};var Co="http.host",Io="http.method",wo="http.request.body.size",Do="http.request_content_length_uncompressed";var Mo="http.scheme",Uo="http.status_code",Go="http.url",Ho="http.user_agent";var K;(function(t){t.METHOD_OPEN="open",t.METHOD_SEND="send",t.EVENT_ABORT="abort",t.EVENT_ERROR="error",t.EVENT_LOAD="loaded",t.EVENT_TIMEOUT="timeout"})(K||(K={}));var Ea=_.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-xml-http-request/utils"});function ga(t){return typeof Document!="undefined"&&t instanceof Document}function Bo(t){if(ga(t))return new XMLSerializer().serializeToString(document).length;if(typeof t=="string")return Vo(t);if(t instanceof Blob)return t.size;if(t instanceof FormData)return Aa(t);if(t instanceof URLSearchParams)return Vo(t.toString());if(t.byteLength!==void 0)return t.byteLength;Ea.warn("unknown body type")}var Sa=new TextEncoder;function Vo(t){return Sa.encode(t).byteLength}function Aa(t){let e=0;for(let[r,n]of t.entries())e+=r.length,n instanceof Blob?e+=n.size:e+=n.length;return e}function ko(t){let e=xa(),r=t.toUpperCase();return r in e?r:"_OTHER"}var Ra={CONNECT:!0,DELETE:!0,GET:!0,HEAD:!0,OPTIONS:!0,PATCH:!0,POST:!0,PUT:!0,TRACE:!0,QUERY:!0},ne;function xa(){if(ne===void 0){let t=void 0;t&&t.length>0?(ne={},t.forEach(e=>{ne[e]=!0})):ne=Ra}return ne}var Oa={"https:":"443","http:":"80"};function Fo(t){let e=Number(t.port||Oa[t.protocol]);if(e&&!isNaN(e))return e}var Dr="0.211.0";var qe;(function(t){t.HTTP_STATUS_TEXT="http.status_text"})(qe||(qe={}));var Na=300,oe=class extends j{constructor(r={}){super("@opentelemetry/instrumentation-xml-http-request",Dr,r);c(this,"component","xml-http-request");c(this,"version",Dr);c(this,"moduleName",this.component);c(this,"_tasksCount",0);c(this,"_xhrMem",new WeakMap);c(this,"_usedResources",new WeakSet);c(this,"_semconvStability");this._semconvStability=Zt("http",r==null?void 0:r.semconvStabilityOptIn)}init(){}_addHeaders(r,n){let o=q(n).href;if(!vr(o,this.getConfig().propagateTraceHeaderCorsUrls)){let s={};I.inject(E.active(),s),Object.keys(s).length>0&&this._diag.debug("headers inject skipped due to CORS policy");return}let i={};I.inject(E.active(),i),Object.keys(i).forEach(s=>{r.setRequestHeader(s,String(i[s]))})}_addChildSpan(r,n){E.with(g.setSpan(E.active(),r),()=>{let o=this.tracer.startSpan("CORS Preflight",{startTime:n[m.FETCH_START]}),i=!(this._semconvStability&R.OLD);_t(o,n,this.getConfig().ignoreNetworkEvents,void 0,i),o.end(n[m.RESPONSE_END])})}_addFinalSpanAttributes(r,n,o){if(this._semconvStability&R.OLD){if(n.status!==void 0&&r.setAttribute(Uo,n.status),n.statusText!==void 0&&r.setAttribute(qe.HTTP_STATUS_TEXT,n.statusText),typeof o=="string"){let i=q(o);r.setAttribute(Co,i.host),r.setAttribute(Mo,i.protocol.replace(":",""))}r.setAttribute(Ho,navigator.userAgent)}this._semconvStability&R.STABLE&&n.status&&r.setAttribute(Fn,n.status)}_applyAttributesAfterXHR(r,n){let o=this.getConfig().applyCustomAttributesOnSpan;typeof o=="function"&&Ot(()=>o(r,n),i=>{i&&this._diag.error("applyCustomAttributesOnSpan",i)},!0)}_addResourceObserver(r,n){let o=this._xhrMem.get(r);!o||typeof PerformanceObserver!="function"||typeof PerformanceResourceTiming!="function"||(o.createdResources={observer:new PerformanceObserver(i=>{let s=i.getEntries(),a=q(n);s.forEach(u=>{u.initiatorType==="xmlhttprequest"&&u.name===a.href&&o.createdResources&&o.createdResources.entries.push(u)})}),entries:[]},o.createdResources.observer.observe({entryTypes:["resource"]}))}_clearResources(){this._tasksCount===0&&this.getConfig().clearTimingResources&&(y.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)}_findResourceAndAddNetworkEvents(r,n,o,i,s){if(!o||!i||!s||!r.createdResources)return;let a=r.createdResources.entries;(!a||!a.length)&&(a=y.getEntriesByType("resource"));let u=yr(q(o).href,i,s,a,this._usedResources);if(u.mainRequest){let p=u.mainRequest;this._markResourceAsUsed(p);let l=u.corsPreFlightRequest;l&&(this._addChildSpan(n,l),this._markResourceAsUsed(l));let f=!(this._semconvStability&R.OLD);_t(n,p,this.getConfig().ignoreNetworkEvents,void 0,f)}}_cleanPreviousSpanInformation(r){let n=this._xhrMem.get(r);if(n){let o=n.callbackToRemoveEvents;o&&o(),this._xhrMem.delete(r)}}_createSpan(r,n,o){if(Ar(n,this.getConfig().ignoreUrls)){this._diag.debug("ignoring span as url matches ignored url");return}let i="",s=q(n),a={};if(this._semconvStability&R.OLD&&(i=o.toUpperCase(),a[Io]=o,a[Go]=s.toString()),this._semconvStability&R.STABLE){let p=o,l=ko(o);i||(i=l),a[Bn]=l,l!==p&&(a[kn]=p),a[ht]=s.toString(),a[jn]=s.hostname;let f=Fo(s);f&&(a[Kn]=f)}let u=this.tracer.startSpan(i,{kind:it.CLIENT,attributes:a});return u.addEvent(K.METHOD_OPEN),this._cleanPreviousSpanInformation(r),this._xhrMem.set(r,{span:u,spanUrl:n}),u}_markResourceAsUsed(r){this._usedResources.add(r)}_patchOpen(){return r=>{let n=this;return function(...i){let s=i[0],a=i[1];return n._createSpan(this,a,s),r.apply(this,i)}}}_patchSend(){let r=this;function n(l,f,T,h){let d=f.callbackToRemoveEvents;typeof d=="function"&&d();let{span:S,spanUrl:N,sendStartTime:A}=f;S&&(r._findResourceAndAddNetworkEvents(f,S,N,A,T),S.addEvent(l,h),r._addFinalSpanAttributes(S,f,N),S.end(h),r._tasksCount--),r._clearResources()}function o(l,f,T,h){let d=r._xhrMem.get(f);if(!d)return;if(d.status=f.status,d.statusText=f.statusText,r._xhrMem.delete(f),d.span){let A=d.span;r._applyAttributesAfterXHR(A,f),r._semconvStability&R.STABLE&&(T?h&&(A.setStatus({code:U.ERROR,message:h}),A.setAttribute(mr,h)):d.status&&d.status>=400&&(A.setStatus({code:U.ERROR}),A.setAttribute(mr,String(d.status))))}let S=Y(),N=Date.now();setTimeout(()=>{n(l,d,S,N)},Na)}function i(){o(K.EVENT_ERROR,this,!0,"error")}function s(){o(K.EVENT_ABORT,this,!1)}function a(){o(K.EVENT_TIMEOUT,this,!0,"timeout")}function u(){this.status<299?o(K.EVENT_LOAD,this,!1):o(K.EVENT_ERROR,this,!1)}function p(l){l.removeEventListener("abort",s),l.removeEventListener("error",i),l.removeEventListener("load",u),l.removeEventListener("timeout",a);let f=r._xhrMem.get(l);f&&(f.callbackToRemoveEvents=void 0)}return l=>function(...T){let h=r._xhrMem.get(this);if(!h)return l.apply(this,T);let d=h.span,S=h.spanUrl;if(d&&S){if(r.getConfig().measureRequestSize&&(T!=null&&T[0])){let N=T[0],A=Bo(N);A!==void 0&&(r._semconvStability&R.OLD&&d.setAttribute(Do,A),r._semconvStability&R.STABLE&&d.setAttribute(wo,A))}E.with(g.setSpan(E.active(),d),()=>{r._tasksCount++,h.sendStartTime=Y(),d.addEvent(K.METHOD_SEND),this.addEventListener("abort",s),this.addEventListener("error",i),this.addEventListener("load",u),this.addEventListener("timeout",a),h.callbackToRemoveEvents=()=>{p(this),h.createdResources&&h.createdResources.observer.disconnect()},r._addHeaders(this,S),r._addResourceObserver(this,S)})}return l.apply(this,T)}}enable(){this._diag.debug("applying patch to",this.moduleName,this.version),O(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),O(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())}disable(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet}};var ie=class{constructor(e){c(this,"_delegate");this._delegate=e}export(e,r){this._delegate.export(e,r)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}};var se=class extends Error{constructor(r,n,o){super(r);c(this,"code");c(this,"name","OTLPExporterError");c(this,"data");this.data=o,this.code=n}};function ya(t){if(Number.isFinite(t)&&t>0)return t;throw new Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${t}')`)}function jo(t){if(t!=null)return async()=>t}function Ko(t,e,r){var n,o,i,s,a,u;return{timeoutMillis:ya((o=(n=t.timeoutMillis)!=null?n:e.timeoutMillis)!=null?o:r.timeoutMillis),concurrencyLimit:(s=(i=t.concurrencyLimit)!=null?i:e.concurrencyLimit)!=null?s:r.concurrencyLimit,compression:(u=(a=t.compression)!=null?a:e.compression)!=null?u:r.compression}}function zo(){return{timeoutMillis:1e4,concurrencyLimit:30,compression:"none"}}var Mr=class{constructor(e){c(this,"_concurrencyLimit");c(this,"_sendingPromises",[]);this._concurrencyLimit=e}pushPromise(e){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(e);let r=()=>{let n=this._sendingPromises.indexOf(e);this._sendingPromises.splice(n,1)};e.then(r,r)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}};function $o(t){return new Mr(t.concurrencyLimit)}function va(t){return Object.prototype.hasOwnProperty.call(t,"partialSuccess")}function Yo(){return{handleResponse(t){t==null||!va(t)||t.partialSuccess==null||Object.keys(t.partialSuccess).length===0||_.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}}}var Ur=class{constructor(e,r,n,o,i){c(this,"_diagLogger");c(this,"_transport");c(this,"_serializer");c(this,"_responseHandler");c(this,"_promiseQueue");c(this,"_timeout");this._transport=e,this._serializer=r,this._responseHandler=n,this._promiseQueue=o,this._timeout=i,this._diagLogger=_.createComponentLogger({namespace:"OTLPExportDelegate"})}export(e,r){if(this._diagLogger.debug("items to be sent",e),this._promiseQueue.hasReachedLimit()){r({code:w.FAILED,error:new Error("Concurrent export limit reached")});return}let n=this._serializer.serializeRequest(e);if(n==null){r({code:w.FAILED,error:new Error("Nothing to send")});return}this._promiseQueue.pushPromise(this._transport.send(n,this._timeout).then(o=>{var i;if(o.status==="success"){if(o.data!=null)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(o.data))}catch(s){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",s,o.data)}r({code:w.SUCCESS});return}else if(o.status==="failure"&&o.error){r({code:w.FAILED,error:o.error});return}else o.status==="retryable"?r({code:w.FAILED,error:(i=o.error)!=null?i:new se("Export failed with retryable status")}):r({code:w.FAILED,error:new se("Export failed with unknown error")})},o=>r({code:w.FAILED,error:o})))}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}};function Xo(t,e){return new Ur(t.transport,t.serializer,Yo(),t.promiseHandler,e.timeout)}function Gr(t,e,r){return Xo({transport:r,serializer:e,promiseHandler:$o(t)},{timeout:t.timeoutMillis})}function Wo(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function Qe(t){let e=new Uint8Array(t.length/2),r=0;for(let n=0;n<t.length;n+=2){let o=Wo(t.charCodeAt(n)),i=Wo(t.charCodeAt(n+1));e[r++]=o<<4|i}return e}function Qo(t){let e=BigInt(1e9);return BigInt(Math.trunc(t[0]))*e+BigInt(Math.trunc(t[1]))}function La(t){let e=Number(BigInt.asUintN(32,t)),r=Number(BigInt.asUintN(32,t>>BigInt(32)));return{low:e,high:r}}function Jo(t){let e=Qo(t);return La(e)}function Pa(t){return Qo(t).toString()}var ba=typeof BigInt!="undefined"?Pa:D;function qo(t){return t}function Zo(t){if(t!==void 0)return Qe(t)}var Ca={encodeHrTime:Jo,encodeSpanContext:Qe,encodeOptionalSpanContext:Zo};function ti(t){var n,o;if(t===void 0)return Ca;let e=(n=t.useLongBits)!=null?n:!0,r=(o=t.useHex)!=null?o:!1;return{encodeHrTime:e?Jo:ba,encodeSpanContext:r?qo:Qe,encodeOptionalSpanContext:r?qo:Zo}}function ei(t){let e={attributes:ae(t.attributes),droppedAttributesCount:0},r=t.schemaUrl;return r&&r!==""&&(e.schemaUrl=r),e}function ri(t){return{name:t.name,version:t.version}}function ae(t){return Object.keys(t).map(e=>ni(e,t[e]))}function ni(t,e){return{key:t,value:oi(e)}}function oi(t){let e=typeof t;return e==="string"?{stringValue:t}:e==="number"?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:e==="boolean"?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(oi)}}:e==="object"&&t!=null?{kvlistValue:{values:Object.entries(t).map(([r,n])=>ni(r,n))}}:{}}var Ia=256,wa=512;function ii(t,e){let r=t&255|Ia;return e&&(r|=wa),r}function Da(t,e){var i,s,a,u;let r=t.spanContext(),n=t.status,o=(i=t.parentSpanContext)!=null&&i.spanId?e.encodeSpanContext((s=t.parentSpanContext)==null?void 0:s.spanId):void 0;return{traceId:e.encodeSpanContext(r.traceId),spanId:e.encodeSpanContext(r.spanId),parentSpanId:o,traceState:(a=r.traceState)==null?void 0:a.serialize(),name:t.name,kind:t.kind==null?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:ae(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(p=>Ua(p,e)),droppedEventsCount:t.droppedEventsCount,status:{code:n.code,message:n.message},links:t.links.map(p=>Ma(p,e)),droppedLinksCount:t.droppedLinksCount,flags:ii(r.traceFlags,(u=t.parentSpanContext)==null?void 0:u.isRemote)}}function Ma(t,e){var r;return{attributes:t.attributes?ae(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:(r=t.context.traceState)==null?void 0:r.serialize(),droppedAttributesCount:t.droppedAttributesCount||0,flags:ii(t.context.traceFlags,t.context.isRemote)}}function Ua(t,e){return{attributes:t.attributes?ae(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}function si(t,e){let r=ti(e);return{resourceSpans:Ha(t,r)}}function Ga(t){let e=new Map;for(let r of t){let n=e.get(r.resource);n||(n=new Map,e.set(r.resource,n));let o=`${r.instrumentationScope.name}@${r.instrumentationScope.version||""}:${r.instrumentationScope.schemaUrl||""}`,i=n.get(o);i||(i=[],n.set(o,i)),i.push(r)}return e}function Ha(t,e){let r=Ga(t),n=[],o=r.entries(),i=o.next();for(;!i.done;){let[s,a]=i.value,u=[],p=a.values(),l=p.next();for(;!l.done;){let h=l.value;if(h.length>0){let d=h.map(S=>Da(S,e));u.push({scope:ri(h[0].instrumentationScope),spans:d,schemaUrl:h[0].instrumentationScope.schemaUrl})}l=p.next()}let f=ei(s),T={resource:f,scopeSpans:u,schemaUrl:f.schemaUrl};n.push(T),i=o.next()}return n}var Je={serializeRequest:t=>{let e=si(t,{useHex:!0,useLongBits:!1});return new TextEncoder().encode(JSON.stringify(e))},deserializeResponse:t=>{if(t.length===0)return{};let e=new TextDecoder;return JSON.parse(e.decode(t))}};var Hr=5,Va=1e3,Ba=5e3,ka=1.5,ai=.2;function Fa(){return Math.random()*(2*ai)-ai}var Vr=class{constructor(e){c(this,"_transport");this._transport=e}retry(e,r,n){return new Promise((o,i)=>{setTimeout(()=>{this._transport.send(e,r).then(o,i)},n)})}async send(e,r){var a;let n=Hr,o=Va,i=Date.now()+r,s=await this._transport.send(e,r);for(;s.status==="retryable"&&n>0;){n--;let u=Math.max(Math.min(o*(1+Fa()),Ba),0);o=o*ka;let p=(a=s.retryInMillis)!=null?a:u,l=i-Date.now();if(p>l)return _.info(`Export retry time ${Math.round(p)}ms exceeds remaining timeout ${Math.round(l)}ms, not retrying further.`),s;_.verbose(`Scheduling export retry in ${Math.round(p)}ms`),s=await this.retry(e,l,p)}return s.status==="success"?_.verbose(`Export succeeded after ${Hr-n} retry attempts.`):s.status==="retryable"?_.info(`Export failed after maximum retry attempts (${Hr}).`):_.info(`Export failed with non-retryable error: ${s.error}`),s}shutdown(){return this._transport.shutdown()}};function Br(t){return new Vr(t.transport)}var kr=class{constructor(e){c(this,"_params");this._params=e}async send(e){let r=(await this._params.headers())["Content-Type"];return new Promise(n=>{navigator.sendBeacon(this._params.url,new Blob([e],{type:r}))?(_.debug("SendBeacon success"),n({status:"success"})):n({status:"failure",error:new Error("SendBeacon failed")})})}shutdown(){}};function ci(t){return new kr(t)}function ui(t){return t===429||t===502||t===503||t===504}function pi(t){if(t==null)return;let e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?e*1e3:-1;let r=new Date(t).getTime()-Date.now();return r>=0?r:0}var Fr=class{constructor(e){c(this,"_parameters");this._parameters=e}async send(e,r){var i;let n=new AbortController,o=setTimeout(()=>n.abort(),r);try{let s=!!globalThis.location,a=new URL(this._parameters.url),u=await fetch(a.href,{method:"POST",headers:await this._parameters.headers(),body:e,signal:n.signal,keepalive:s,mode:s?((i=globalThis.location)==null?void 0:i.origin)===a.origin?"same-origin":"cors":"no-cors"});if(u.status>=200&&u.status<=299)return _.debug("response success"),{status:"success"};if(ui(u.status)){let p=u.headers.get("Retry-After");return{status:"retryable",retryInMillis:pi(p)}}return{status:"failure",error:new Error("Fetch request failed with non-retryable status")}}catch(s){return ja(s)?{status:"retryable",error:new Error("Fetch request encountered a network error",{cause:s})}:{status:"failure",error:new Error("Fetch request errored",{cause:s})}}finally{clearTimeout(o)}}shutdown(){}};function li(t){return new Fr(t)}function ja(t){return t instanceof TypeError&&!t.cause}function _i(t,e){return Gr(t,e,Br({transport:li(t)}))}function fi(t,e){return Gr(t,e,Br({transport:ci({url:t.url,headers:t.headers})}))}function di(t){let e={};return Object.entries(t!=null?t:{}).forEach(([r,n])=>{typeof n!="undefined"?e[r]=String(n):_.warn(`Header "${r}" has invalid value (${n}) and will be ignored`)}),e}function Ka(t,e,r){return async()=>{let n={...await r()},o={};return e!=null&&Object.assign(o,await e()),t!=null&&Object.assign(o,di(await t())),Object.assign(o,n)}}function za(t){var e;if(t!=null)try{let r=(e=globalThis.location)==null?void 0:e.href;return new URL(t,r).href}catch(r){throw new Error(`Configuration: Could not parse user-provided export URL: '${t}'`)}}function mi(t,e,r){var n,o;return{...Ko(t,e,r),headers:Ka(t.headers,e.headers,r.headers),url:(o=(n=za(t.url))!=null?n:e.url)!=null?o:r.url}}function Ti(t,e){return{...zo(),headers:async()=>t,url:"http://localhost:4318/"+e}}function hi(t){return typeof t.headers=="function"?t.headers:jo(t.headers)}function Ei(t,e,r){return mi({url:t.url,timeoutMillis:t.timeoutMillis,headers:hi(t),concurrencyLimit:t.concurrencyLimit},{},Ti(r,e))}function jr(t,e,r,n){let o=$a(t.headers),i=Ei(t,r,n);return o(i,e)}function $a(t){return!t&&typeof navigator.sendBeacon=="function"?fi:_i}var Nt=class extends ie{constructor(e={}){super(jr(e,Je,"v1/traces",{"Content-Type":"application/json"}))}};var yi=-1,ce=t=>{addEventListener("pageshow",(e=>{e.persisted&&(yi=e.timeStamp,t(e))}),!0)},et=(t,e,r,n)=>{let o,i;return s=>{e.value>=0&&(s||n)&&(i=e.value-(o!=null?o:0),(i||o===void 0)&&(o=e.value,e.delta=i,e.rating=((a,u)=>a>u[1]?"poor":a>u[0]?"needs-improvement":"good")(e.value,r),t(e)))}},Qr=t=>{requestAnimationFrame((()=>requestAnimationFrame((()=>t()))))},vi=()=>{let t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},tr=()=>{var e;let t=vi();return(e=t==null?void 0:t.activationStart)!=null?e:0},rt=(t,e=-1)=>{let r=vi(),n="navigate";return yi>=0?n="back-forward-cache":r&&(document.prerendering||tr()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},Kr=new WeakMap;function Jr(t,e){return Kr.get(t)||Kr.set(t,new e),Kr.get(t)}var $r=class{constructor(){c(this,"t");c(this,"i",0);c(this,"o",[])}h(e){var o;if(e.hadRecentInput)return;let r=this.o[0],n=this.o.at(-1);this.i&&r&&n&&e.startTime-n.startTime<1e3&&e.startTime-r.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),(o=this.t)==null||o.call(this,e)}},ue=(t,e,r={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){let n=new PerformanceObserver((o=>{Promise.resolve().then((()=>{e(o.getEntries())}))}));return n.observe({type:t,buffered:!0,...r}),n}}catch(n){}},Zr=t=>{let e=!1;return()=>{e||(t(),e=!0)}},yt=-1,Li=new Set,gi=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,Yr=t=>{if(document.visibilityState==="hidden"){if(t.type==="visibilitychange")for(let e of Li)e();isFinite(yt)||(yt=t.type==="visibilitychange"?t.timeStamp:0,removeEventListener("prerenderingchange",Yr,!0))}},er=()=>{var t;if(yt<0){let e=tr(),r=document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter((n=>n.name==="hidden"&&n.startTime>e))[0])==null?void 0:t.startTime;yt=r!=null?r:gi(),addEventListener("visibilitychange",Yr,!0),addEventListener("prerenderingchange",Yr,!0),ce((()=>{setTimeout((()=>{yt=gi()}))}))}return{get firstHiddenTime(){return yt},onHidden(e){Li.add(e)}}},tn=t=>{document.prerendering?addEventListener("prerenderingchange",(()=>t()),!0):t()},Si=[1800,3e3],Ya=(t,e={})=>{tn((()=>{let r=er(),n,o=rt("FCP"),i=ue("paint",(s=>{for(let a of s)a.name==="first-contentful-paint"&&(i.disconnect(),a.startTime<r.firstHiddenTime&&(o.value=Math.max(a.startTime-tr(),0),o.entries.push(a),n(!0)))}));i&&(n=et(t,o,Si,e.reportAllChanges),ce((s=>{o=rt("FCP"),n=et(t,o,Si,e.reportAllChanges),Qr((()=>{o.value=performance.now()-s.timeStamp,n(!0)}))})))}))},Ai=[.1,.25],Pi=(t,e={})=>{let r=er();Ya(Zr((()=>{let n,o=rt("CLS",0),i=Jr(e,$r),s=u=>{for(let p of u)i.h(p);i.i>o.value&&(o.value=i.i,o.entries=i.o,n())},a=ue("layout-shift",s);a&&(n=et(t,o,Ai,e.reportAllChanges),r.onHidden((()=>{s(a.takeRecords()),n(!0)})),ce((()=>{i.i=0,o=rt("CLS",0),n=et(t,o,Ai,e.reportAllChanges),Qr((()=>n()))})),setTimeout(n))})))},bi=0,zr=1/0,Ze=0,Xa=t=>{for(let e of t)e.interactionId&&(zr=Math.min(zr,e.interactionId),Ze=Math.max(Ze,e.interactionId),bi=Ze?(Ze-zr)/7+1:0)},Xr,Ri=()=>{var t;return Xr?bi:(t=performance.interactionCount)!=null?t:0},Wa=()=>{"interactionCount"in performance||Xr||(Xr=ue("event",Xa,{type:"event",buffered:!0,durationThreshold:0}))},xi=0,Wr=class{constructor(){c(this,"u",[]);c(this,"l",new Map);c(this,"m");c(this,"p")}v(){xi=Ri(),this.u.length=0,this.l.clear()}L(){let e=Math.min(this.u.length-1,Math.floor((Ri()-xi)/50));return this.u[e]}h(e){var o,i;if((o=this.m)==null||o.call(this,e),!e.interactionId&&e.entryType!=="first-input")return;let r=this.u.at(-1),n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>r.P){if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort(((s,a)=>a.P-s.P)),this.u.length>10){let s=this.u.splice(10);for(let a of s)this.l.delete(a.id)}(i=this.p)==null||i.call(this,n)}}},Ci=t=>{let e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(t=Zr(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e((()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})})))},Oi=[200,500],Ii=(t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;let r=er();tn((()=>{var u;Wa();let n,o=rt("INP"),i=Jr(e,Wr),s=p=>{Ci((()=>{for(let f of p)i.h(f);let l=i.L();l&&l.P!==o.value&&(o.value=l.P,o.entries=l.entries,n())}))},a=ue("event",s,{durationThreshold:(u=e.durationThreshold)!=null?u:40});n=et(t,o,Oi,e.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),r.onHidden((()=>{s(a.takeRecords()),n(!0)})),ce((()=>{i.v(),o=rt("INP"),n=et(t,o,Oi,e.reportAllChanges)})))}))},qr=class{constructor(){c(this,"m")}h(e){var r;(r=this.m)==null||r.call(this,e)}},Ni=[2500,4e3],wi=(t,e={})=>{tn((()=>{let r=er(),n,o=rt("LCP"),i=Jr(e,qr),s=u=>{e.reportAllChanges||(u=u.slice(-1));for(let p of u)i.h(p),p.startTime<r.firstHiddenTime&&(o.value=Math.max(p.startTime-tr(),0),o.entries=[p],n())},a=ue("largest-contentful-paint",s);if(a){n=et(t,o,Ni,e.reportAllChanges);let u=Zr((()=>{s(a.takeRecords()),a.disconnect(),n(!0)})),p=l=>{l.isTrusted&&(Ci(u),removeEventListener(l.type,p,{capture:!0}))};for(let l of["keydown","click","visibilitychange"])addEventListener(l,p,{capture:!0});ce((l=>{o=rt("LCP"),n=et(t,o,Ni,e.reportAllChanges),Qr((()=>{o.value=performance.now()-l.timeStamp,n(!0)}))}))}}))};(function(){var f,T,h;let e=window.MatomoOpenTelemetry||{};if(!e.enabled)return;let r=(f=e.traceUrl)!=null?f:"",n=(T=e.serviceName)!=null?T:"matomo-frontend",o=new Yt({resource:Ie({"service.name":n}),spanProcessors:[new At(new Nt({url:r}))]});o.register();let i=[];e.enableDocumentLoadMonitoring&&i.push(new ee),e.enableUserInteractionMonitoring&&i.push(new re),e.enableXMLHttpRequestMonitoring&&i.push(new oe({propagateTraceHeaderCorsUrls:[/.*/]})),i.length>0&&br({instrumentations:i});let s=g.getTracer(n),a=null,u=E.active();if(e.enableUxMonitoring){let d=function(){a&&a.end(),a=s.startSpan("ui.page",{attributes:{"http.url":window.location.href,"http.path":window.location.pathname,"http.title":document.title}}),u=g.setSpan(E.active(),a)};d(),window.addEventListener("hashchange",()=>{d()}),window.addEventListener("beforeunload",()=>{a&&a.end()})}function p(d,S){var N;try{let A=s.startSpan(d,{},u);A.recordException(S),A.setStatus({code:U.ERROR}),A.setAttribute("error.message",S.message),A.setAttribute("error.name",S.name),A.setAttribute("error.stack",(N=S.stack)!=null?N:""),A.setAttribute("http.url",window.location.href),A.setAttribute("http.path",window.location.pathname),A.setAttribute("http.title",document.title),A.end(),o.forceFlush()}catch(A){console.warn("OpenTelemetry: failed to record error span",A)}}window.addEventListener("error",d=>{p("js.error",d.error||new Error(d.message))}),window.addEventListener("unhandledrejection",d=>{p("js.unhandled_promise",d.reason instanceof Error?d.reason:new Error(String(d.reason)))});function l(){let d=document.getElementById("ajaxError");if(!d)return;new MutationObserver(N=>{var A,vt,Lt,Pt;for(let mt of N)for(let Q of mt.addedNodes){if(!(Q instanceof HTMLElement))continue;let en=(A=Q.matches)!=null&&A.call(Q,".notification-error")?Q:(vt=Q.querySelector)==null?void 0:vt.call(Q,".notification-error");if(!en)continue;let rn=(Pt=(Lt=en.querySelector(".notification-body div"))==null?void 0:Lt.innerText)==null?void 0:Pt.trim();if(!rn)continue;let nn=s.startSpan("ui.notification.error",{attributes:{"ui.notification.type":"error","ui.notification.message":rn,"http.url":window.location.href,"http.path":window.location.pathname}},u);nn.setStatus({code:U.ERROR}),nn.end()}}).observe(d,{childList:!0,subtree:!0})}if(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",l):l(),e.enableWebVitals){let d=function(S){let N=s.startSpan("browser.web_vital",{attributes:{"http.url":window.location.href,"http.path":window.location.pathname}},u);N.addEvent("browser.web_vital",{name:S.name,value:S.value,delta:S.delta,id:S.id}),N.end()};Pi(d),wi(d),Ii(d)}e.enableUxMonitoring&&"PerformanceObserver"in window&&((h=PerformanceObserver.supportedEntryTypes)!=null&&h.includes("longtask"))&&new PerformanceObserver(S=>{for(let N of S.getEntries()){let A=s.startSpan("ux.long_task",{attributes:{"http.url":window.location.href,"http.path":window.location.pathname}},u);A.addEvent("ux.long_task",{duration:N.duration,startTime:N.startTime}),A.end()}}).observe({entryTypes:["longtask"]})})();})();
